#!/bin/bash
# By  : Automatic Generated by at.3.testcase.pl
# Date: Mon Feb 28 10:07:10 2011

#############################################
#  test suite: ipa-join (28 test cases)
#############################################
ipajoin()
{
    ipa_join_envsetup
    ipa_join_1001  #test_scenario (positive test): [--unenroll]
    ipa_join_1002  #test_scenario (positive test): [--hostname;positive;FQDN]
    ipa_join_1003  #test_scenario (negative test): [--hostname;positive;FQDN --bindpw;negative;InvalidPW]
    ipa_join_1004  #test_scenario (positive test): [--hostname;positive;FQDN --bindpw;positive;ValidPW]
    ipa_join_1005  #test_scenario (positive test): [--hostname;positive;FQDN --keytab;positive;ValidKeytab]
    ipa_join_1006  #test_scenario (negative test): [--hostname;positive;FQDN --keytab;positive;ValidKeytab --bindpw;negative;InvalidPW]
    ipa_join_1007  #test_scenario (positive test): [--hostname;positive;FQDN --keytab;positive;ValidKeytab --bindpw;positive;ValidPW]
    ipa_join_1008  #test_scenario (negative test): [--hostname;positive;FQDN --server;negative;NoSuchDomain]
    ipa_join_1009  #test_scenario (negative test): [--hostname;positive;FQDN --server;negative;NoSuchDomain --bindpw;positive;ValidPW]
    ipa_join_1010  #test_scenario (negative test): [--hostname;positive;FQDN --server;negative;NoSuchDomain --keytab;positive;ValidKeytab]
    ipa_join_1011  #test_scenario (negative test): [--hostname;positive;FQDN --server;negative;NoSuchDomain --keytab;positive;ValidKeytab --bindpw;positive;ValidPW]
    ipa_join_1012  #test_scenario (positive test): [--hostname;positive;FQDN --server;positive;FQDN]
    ipa_join_1013  #test_scenario (negative test): [--hostname;positive;FQDN --server;positive;FQDN --bindpw;negative;InvalidPW]
    ipa_join_1014  #test_scenario (positive test): [--hostname;positive;FQDN --server;positive;FQDN --bindpw;positive;ValidPW]
    ipa_join_1015  #test_scenario (positive test): [--hostname;positive;FQDN --server;positive;FQDN --keytab;positive;ValidKeytab]
    ipa_join_1016  #test_scenario (negative test): [--hostname;positive;FQDN --server;positive;FQDN --keytab;positive;ValidKeytab --bindpw;negative;InvalidPW]
    ipa_join_1017  #test_scenario (positive test): [--hostname;positive;FQDN --server;positive;FQDN --keytab;positive;ValidKeytab --bindpw;positive;ValidPW]
    ipa_join_1018  #test_scenario (positive test): [--keytab;positive;ValidKeytab]
    ipa_join_1019  #test_scenario (negative test): [--keytab;positive;ValidKeytab --bindpw;negative;InvalidPW]
    ipa_join_1020  #test_scenario (positive test): [--keytab;positive;ValidKeytab --bindpw;positive;ValidPW]
    ipa_join_1021  #test_scenario (negative test): [--server;negative;NoSuchDomain]
    ipa_join_1022  #test_scenario (negative test): [--server;negative;NoSuchDomain --bindpw;positive;ValidPW]
    ipa_join_1023  #test_scenario (negative test): [--server;negative;NoSuchDomain--keytab;positive;ValidKeytab]
    ipa_join_1024  #test_scenario (positive test): [--server;positive;FQDN]
    ipa_join_1025  #test_scenario (negative test): [--server;positive;FQDN --bindpw;negative;InvalidPW]
    ipa_join_1026  #test_scenario (positive test): [--server;positive;FQDN --bindpw;positive;ValidPW]
    ipa_join_1027  #test_scenario (positive test): [--server;positive;FQDN --keytab;positive;ValidKeytab]
    ipa_join_1028  #test_scenario (negative test): [--bindpw;negative;InvalidPW]
    ipaotp         # run OTP (one time password) test here
    ipa_join_envcleanup
} #ipajoin

ipa_join_envsetup()
{
    rlPhaseStartSetup "ipa_join_envsetup"
        #environment setup starts here
        #install_ipa_client #ipa client host configuration has been take care of by ipa install script
        rlRun "ssh root@$serverFQDN \"echo $ADMINPW | kinit $ADMINID\" " 0 "kinit at remote ipa server as admin"
        #environment setup ends   here
    rlPhaseEnd
} #envsetup

ipa_join_envcleanup()
{
    rlPhaseStartCleanup "ipa_join_envcleanup"
        #environment cleanup starts here
        uninstall_ipa_client
        # remove the possible leftover: test keytab file
        if [ -f $testKeytabfile ];then
            rm $testKeytabfile
        fi
        delete_clientHostEntry_FromIPAServer
        rlRun "ssh root@$serverFQDN \"kdestroy\"" 0 "remove kerboros ticket in remote server"
        #environment cleanup ends   here
    rlPhaseEnd
} #envcleanup

ipa_join_1001()
{
    rlPhaseStartTest "ipa_join_1001 [positive test] --unenroll"
        local testID="ipa_join_1001"
        rlRun "ipa-join -u" "0" "unenroll client with '-u' " 
    rlPhaseEnd
} #ipa_join_1001

ipa_join_1002()
{
    rlPhaseStartTest "ipa_join_1002 [positive test] --hostname;positive;FQDN"
        local testID="ipa_join_1002"
        local tmpout=$TmpDir/ipa_join_1002.$RANDOM.out
        KinitAsAdmin
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        rlRun "ipa-join --hostname=$hostname_TestValue " 0 "test options:  [hostname]=[$hostname_TestValue]" 
        Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1002

ipa_join_1003()
{
    rlPhaseStartTest "ipa_join_1003 [negative test] --hostname;positive;FQDN --bindpw;negative;InvalidPW"
        local testID="ipa_join_1003"
        local tmpout=$TmpDir/ipa_join_1003.$RANDOM.out
        #KinitAsAdmin
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local bindpw_TestValue_Negative="WrongPassword" #bindpw;negative;InvalidPW
        local expectedErrMsg="Incorrect password"
        local expectedErrCode=15
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "we have to un-join before test starts"
        #remove the client host record
        ssh root@$serverFQDN "ipa host-add $clientFQDN --password=$OTP"
        qaRun "ipa-join --hostname=$hostname_TestValue  --bindpw=$bindpw_TestValue_Negative " "$tmpout" $expectedErrCode "$expectedErrMsg" "test options:  [hostname]=[$hostname_TestValue] [bindpw]=[$bindpw_TestValue_Negative]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1003

ipa_join_1004()
{
    rlPhaseStartTest "ipa_join_1004 [positive test] --hostname;positive;FQDN --bindpw;positive;ValidPW"
        local testID="ipa_join_1004"
        local tmpout=$TmpDir/ipa_join_1004.$RANDOM.out
        #KinitAsAdmin
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local bindpw_TestValue=$OTP #bindpw;positive;ValidPW
        rlRun "ipa-join --hostname=$hostname_TestValue  --bindpw=$OTP" 0 "test options:  [hostname]=[$hostname_TestValue] [bindpw]=[$bindpw_TestValue]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1004

ipa_join_1005()
{
    rlPhaseStartTest "ipa_join_1005 [positive test] --hostname;positive;FQDN --keytab;positive;ValidKeytab"
        local testID="ipa_join_1005"
        local tmpout=$TmpDir/ipa_join_1005.$RANDOM.out
        KinitAsAdmin
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local keytab_TestValue="$testKeytabfile" #keytab;positive;ValidKeytab
        rlRun "ipa-join --hostname=$hostname_TestValue  --keytab=$keytab_TestValue " 0 "test options:  [hostname]=[$hostname_TestValue] [keytab]=[$keytab_TestValue]" 
        Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1005

ipa_join_1006()
{
    rlPhaseStartTest "ipa_join_1006 [negative test] --hostname;positive;FQDN --keytab;positive;ValidKeytab --bindpw;negative;InvalidPW"
        local testID="ipa_join_1006"
        local tmpout=$TmpDir/ipa_join_1006.$RANDOM.out
        #KinitAsAdmin

        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        rlRun "ssh root@$serverFQDN \"ipa host-add $clientFQDN\" --password=$OTP" 0 "add $clientFQDN and set OTP"
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local keytab_TestValue="$testKeytabfile" #keytab;positive;ValidKeytab
        local bindpw_TestValue_Negative="WrongPassword" #bindpw;negative;InvalidPW
        local expectedErrMsg="Incorrect password"
        local expectedErrCode=15
        qaRun "ipa-join --hostname=$hostname_TestValue  --keytab=$keytab_TestValue  --bindpw=$bindpw_TestValue_Negative " "$tmpout" $expectedErrCode "$expectedErrMsg" "test options:  [hostname]=[$hostname_TestValue] [keytab]=[$keytab_TestValue] [bindpw]=[$bindpw_TestValue_Negative]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1006

ipa_join_1007()
{
    rlPhaseStartTest "ipa_join_1007 [positive test] --hostname;positive;FQDN --keytab;positive;ValidKeytab --bindpw;positive;ValidPW"
        local testID="ipa_join_1007"
        local tmpout=$TmpDir/ipa_join_1007.$RANDOM.out
        #KinitAsAdmin
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local keytab_TestValue="$testKeytabfile" #keytab;positive;ValidKeytab
        local bindpw_TestValue=$OTP #bindpw;positive;ValidPW
        rlRun "ipa-join --hostname=$hostname_TestValue  --keytab=$keytab_TestValue  --bindpw=$bindpw_TestValue " 0 "test options:  [hostname]=[$hostname_TestValue] [keytab]=[$keytab_TestValue] [bindpw]=[$bindpw_TestValue]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1007

ipa_join_1008()
{
    rlPhaseStartTest "ipa_join_1008 [negative test] --hostname;positive;FQDN --server;negative;NoSuchDomain"
        local testID="ipa_join_1008"
        local tmpout=$TmpDir/ipa_join_1008.$RANDOM.out
        KinitAsAdmin
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local server_TestValue_Negative="No.Such.IPA.Server.Domain.com" #server;negative;NoSuchDomain
        local expectedErrMsg="libcurl failed to execute the HTTP POST transaction"
        local expectedErrCode=17
        qaRun "ipa-join --hostname=$hostname_TestValue  --server=$server_TestValue_Negative " "$tmpout" $expectedErrCode "$expectedErrMsg" "test options:  [hostname]=[$hostname_TestValue] [server]=[$server_TestValue_Negative]" 
        Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1008

ipa_join_1009()
{
    rlPhaseStartTest "ipa_join_1009 [negative test] --hostname;positive;FQDN --server;negative;NoSuchDomain --bindpw;positive;ValidPW"
        local testID="ipa_join_1009"
        local tmpout=$TmpDir/ipa_join_1009.$RANDOM.out
        #KinitAsAdmin
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local server_TestValue_Negative="No.Such.IPA.Server.Domain.com" #server;negative;NoSuchDomain
        local bindpw_TestValue=$OTP #bindpw;positive;ValidPW
        local expectedErrMsg="Unable to determine root DN of $server_TestValue_Negative"
        local expectedErrCode=14
        qaRun "ipa-join --hostname=$hostname_TestValue  --server=$server_TestValue_Negative  --bindpw=$bindpw_TestValue " "$tmpout" $expectedErrCode "$expectedErrMsg" "test options:  [hostname]=[$hostname_TestValue] [server]=[$server_TestValue_Negative] [bindpw]=[$bindpw_TestValue]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1009

ipa_join_1010()
{
    rlPhaseStartTest "ipa_join_1010 [negative test] --hostname;positive;FQDN --server;negative;NoSuchDomain --keytab;positive;ValidKeytab"
        local testID="ipa_join_1010"
        local tmpout=$TmpDir/ipa_join_1010.$RANDOM.out
        KinitAsAdmin
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local server_TestValue_Negative="No.Such.IPA.Server.Domain.com" #server;negative;NoSuchDomain
        local keytab_TestValue="$testKeytabfile" #keytab;positive;ValidKeytab
        local expectedErrMsg="libcurl failed to execute the HTTP POST transaction"
        local expectedErrCode=17
        qaRun "ipa-join --hostname=$hostname_TestValue  --server=$server_TestValue_Negative  --keytab=$keytab_TestValue " "$tmpout" $expectedErrCode "$expectedErrMsg" "test options:  [hostname]=[$hostname_TestValue] [server]=[$server_TestValue_Negative] [keytab]=[$keytab_TestValue]" 
        Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1010

ipa_join_1011()
{
    rlPhaseStartTest "ipa_join_1011 [negative test] --hostname;positive;FQDN --server;negative;NoSuchDomain --keytab;positive;ValidKeytab --bindpw;positive;ValidPW"
        local testID="ipa_join_1011"
        local tmpout=$TmpDir/ipa_join_1011.$RANDOM.out
        #KinitAsAdmin
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local server_TestValue_Negative="No.Such.IPA.Server.Domain.com" #server;negative;NoSuchDomain
        local keytab_TestValue="$testKeytabfile" #keytab;positive;ValidKeytab
        local bindpw_TestValue=$OTP #bindpw;positive;ValidPW
        local expectedErrMsg="Unable to determine root DN of $server_TestValue_Negative"
        local expectedErrCode=14
        qaRun "ipa-join --hostname=$hostname_TestValue  --server=$server_TestValue_Negative  --keytab=$keytab_TestValue  --bindpw=$bindpw_TestValue " "$tmpout" $expectedErrCode "$expectedErrMsg" "test options:  [hostname]=[$hostname_TestValue] [server]=[$server_TestValue_Negative] [keytab]=[$keytab_TestValue] [bindpw]=[$bindpw_TestValue]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1011

ipa_join_1012()
{
    rlPhaseStartTest "ipa_join_1012 [positive test] --hostname;positive;FQDN --server;positive;FQDN"
        local testID="ipa_join_1012"
        local tmpout=$TmpDir/ipa_join_1012.$RANDOM.out
        KinitAsAdmin
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local server_TestValue="$serverFQDN" #server;positive;FQDN
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        rlRun "ipa-join --hostname=$hostname_TestValue  --server=$server_TestValue " 0 "test options:  [hostname]=[$hostname_TestValue] [server]=[$server_TestValue]" 
        Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1012

ipa_join_1013()
{
    rlPhaseStartTest "ipa_join_1013 [negative test] --hostname;positive;FQDN --server;positive;FQDN --bindpw;negative;InvalidPW"
        local testID="ipa_join_1013"
        local tmpout=$TmpDir/ipa_join_1013.$RANDOM.out
        #KinitAsAdmin
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local server_TestValue="$serverFQDN" #server;positive;FQDN
        local bindpw_TestValue_Negative="WrongPassword" #bindpw;negative;InvalidPW
        local expectedErrMsg="Incorrect password"
        local expectedErrCode=15
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        rlRun "ssh root@$serverFQDN \"ipa host-add $clientFQDN --password=$OTP \"" 0 "add $clientFQDN from ipa server"
        qaRun "ipa-join --hostname=$hostname_TestValue  --server=$server_TestValue  --bindpw=$bindpw_TestValue_Negative " "$tmpout" $expectedErrCode "$expectedErrMsg" "test options:  [hostname]=[$hostname_TestValue] [server]=[$server_TestValue] [bindpw]=[$bindpw_TestValue_Negative]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1013

ipa_join_1014()
{
    rlPhaseStartTest "ipa_join_1014 [positive test] --hostname;positive;FQDN --server;positive;FQDN --bindpw;positive;ValidPW"
        local testID="ipa_join_1014"
        local tmpout=$TmpDir/ipa_join_1014.$RANDOM.out
        #KinitAsAdmin
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local server_TestValue="$serverFQDN" #server;positive;FQDN
        local bindpw_TestValue=$OTP #bindpw;positive;ValidPW
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        rlRun "ssh root@$serverFQDN \"ipa host-add $clientFQDN --password=$OTP \"" 0 "add $clientFQDN from ipa server"
        rlRun "ipa-join --hostname=$hostname_TestValue  --server=$server_TestValue  --bindpw=$bindpw_TestValue " 0 "test options:  [hostname]=[$hostname_TestValue] [server]=[$server_TestValue] [bindpw]=[$bindpw_TestValue]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1014

ipa_join_1015()
{
    rlPhaseStartTest "ipa_join_1015 [positive test] --hostname;positive;FQDN --server;positive;FQDN --keytab;positive;ValidKeytab"
        local testID="ipa_join_1015"
        local tmpout=$TmpDir/ipa_join_1015.$RANDOM.out
        KinitAsAdmin
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local server_TestValue="$serverFQDN" #server;positive;FQDN
        local keytab_TestValue="$testKeytabfile" #keytab;positive;ValidKeytab
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        rlRun "ssh root@$serverFQDN \"ipa host-add $clientFQDN \"" 0 "add $clientFQDN from ipa server"
        rlRun "ipa-join --hostname=$hostname_TestValue  --server=$server_TestValue  --keytab=$keytab_TestValue " 0 "test options:  [hostname]=[$hostname_TestValue] [server]=[$server_TestValue] [keytab]=[$keytab_TestValue]" 
        Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1015

ipa_join_1016()
{
    rlPhaseStartTest "ipa_join_1016 [negative test] --hostname;positive;FQDN --server;positive;FQDN --keytab;positive;ValidKeytab --bindpw;negative;InvalidPW"
        local testID="ipa_join_1016"
        local tmpout=$TmpDir/ipa_join_1016.$RANDOM.out
        #KinitAsAdmin
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local server_TestValue="$serverFQDN" #server;positive;FQDN
        local keytab_TestValue="$testKeytabfile" #keytab;positive;ValidKeytab
        local bindpw_TestValue_Negative="WrongPassword" #bindpw;negative;InvalidPW
        local expectedErrMsg="Incorrect password"
        local expectedErrCode=15
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        rlRun "ssh root@$serverFQDN \"ipa host-add $clientFQDN --password=$OTP \"" 0 "add $clientFQDN from ipa server"
        qaRun "ipa-join --hostname=$hostname_TestValue  --server=$server_TestValue  --keytab=$keytab_TestValue  --bindpw=$bindpw_TestValue_Negative " "$tmpout" $expectedErrCode "$expectedErrMsg" "test options:  [hostname]=[$hostname_TestValue] [server]=[$server_TestValue] [keytab]=[$keytab_TestValue] [bindpw]=[$bindpw_TestValue_Negative]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1016

ipa_join_1017()
{
    rlPhaseStartTest "ipa_join_1017 [positive test] --hostname;positive;FQDN --server;positive;FQDN --keytab;positive;ValidKeytab --bindpw;positive;ValidPW"
        local testID="ipa_join_1017"
        local tmpout=$TmpDir/ipa_join_1017.$RANDOM.out
        #KinitAsAdmin
        local hostname_TestValue="$clientFQDN" #hostname;positive;FQDN
        local server_TestValue="$serverFQDN" #server;positive;FQDN
        local keytab_TestValue="$testKeytabfile" #keytab;positive;ValidKeytab
        local bindpw_TestValue=$OTP #bindpw;positive;ValidPW
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        rlRun "ssh root@$serverFQDN \"ipa host-add $clientFQDN --password=$OTP \"" 0 "add $clientFQDN from ipa server"
        rlRun "ipa-join --hostname=$hostname_TestValue  --server=$server_TestValue  --keytab=$keytab_TestValue  --bindpw=$bindpw_TestValue " 0 "test options:  [hostname]=[$hostname_TestValue] [server]=[$server_TestValue] [keytab]=[$keytab_TestValue] [bindpw]=[$bindpw_TestValue]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1017

ipa_join_1018()
{
    rlPhaseStartTest "ipa_join_1018 [positive test] --keytab;positive;ValidKeytab"
        local testID="ipa_join_1018"
        local tmpout=$TmpDir/ipa_join_1018.$RANDOM.out
        KinitAsAdmin
        local keytab_TestValue="$testKeytabfile" #keytab;positive;ValidKeytab
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        rlRun "ssh root@$serverFQDN \"ipa host-add $clientFQDN \"" 0 "add $clientFQDN from ipa server"
        rlRun "ipa-join --keytab=$keytab_TestValue " 0 "test options:  [keytab]=[$keytab_TestValue]" 
        Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1018

ipa_join_1019()
{
    rlPhaseStartTest "ipa_join_1019 [negative test] --keytab;positive;ValidKeytab --bindpw;negative;InvalidPW"
        local testID="ipa_join_1019"
        local tmpout=$TmpDir/ipa_join_1019.$RANDOM.out
        #KinitAsAdmin
        local keytab_TestValue="$testKeytabfile" #keytab;positive;ValidKeytab
        local bindpw_TestValue_Negative="WrongPassword" #bindpw;negative;InvalidPW
        local expectedErrMsg="Incorrect password"
        local expectedErrCode=15
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        rlRun "ssh root@$serverFQDN \"ipa host-add $clientFQDN --password=$OTP \"" 0 "add $clientFQDN from ipa server"
        qaRun "ipa-join --keytab=$keytab_TestValue  --bindpw=$bindpw_TestValue_Negative " "$tmpout" $expectedErrCode "$expectedErrMsg" "test options:  [keytab]=[$keytab_TestValue] [bindpw]=[$bindpw_TestValue_Negative]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1019

ipa_join_1020()
{
    rlPhaseStartTest "ipa_join_1020 [positive test] --keytab;positive;ValidKeytab --bindpw;positive;ValidPW"
        local testID="ipa_join_1020"
        local tmpout=$TmpDir/ipa_join_1020.$RANDOM.out
        #KinitAsAdmin
        local keytab_TestValue="$testKeytabfile" #keytab;positive;ValidKeytab
        local bindpw_TestValue=$OTP #bindpw;positive;ValidPW
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        rlRun "ssh root@$serverFQDN \"ipa host-add $clientFQDN --password=$OTP \"" 0 "add $clientFQDN from ipa server"
        rlRun "ipa-join --keytab=$keytab_TestValue  --bindpw=$bindpw_TestValue " 0 "test options:  [keytab]=[$keytab_TestValue] [bindpw]=[$bindpw_TestValue]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1020

ipa_join_1021()
{
    rlPhaseStartTest "ipa_join_1021 [negative test] --server;negative;NoSuchDomain"
        local testID="ipa_join_1021"
        local tmpout=$TmpDir/ipa_join_1021.$RANDOM.out
        KinitAsAdmin
        local server_TestValue_Negative="No.Such.IPA.Server.Domain.com" #server;negative;NoSuchDomain
        local expectedErrMsg="libcurl failed to execute the HTTP POST transaction"
        local expectedErrCode=17
        qaRun "ipa-join --server=$server_TestValue_Negative " "$tmpout" $expectedErrCode "$expectedErrMsg" "test options:  [server]=[$server_TestValue_Negative]" 
        Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1021

ipa_join_1022()
{
    rlPhaseStartTest "ipa_join_1022 [negative test] --server;negative;NoSuchDomain --bindpw;positive;ValidPW"
        local testID="ipa_join_1022"
        local tmpout=$TmpDir/ipa_join_1022.$RANDOM.out
        #KinitAsAdmin
        local server_TestValue_Negative="No.Such.IPA.Server.Domain.com" #server;negative;NoSuchDomain
        local bindpw_TestValue=$OTP #bindpw;positive;ValidPW
        local expectedErrMsg="Unable to determine root DN of $server_TestValue_Negative"
        local expectedErrCode=14
        qaRun "ipa-join --server=$server_TestValue_Negative  --bindpw=$bindpw_TestValue " "$tmpout" $expectedErrCode "$expectedErrMsg" "test options:  [server]=[$server_TestValue_Negative] [bindpw]=[$bindpw_TestValue]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1022

ipa_join_1023()
{
    rlPhaseStartTest "ipa_join_1023 [negative test] --server;negative;NoSuchDomain--keytab;positive;ValidKeytab"
        local testID="ipa_join_1023"
        local tmpout=$TmpDir/ipa_join_1023.$RANDOM.out
        KinitAsAdmin
        local server_TestValue_Negative="No.Such.IPA.Server.Domain.com" #server;negative;NoSuchDomain
        local keytab_TestValue="$testKeytabfile" #keytab;positive;ValidKeytab
        local expectedErrMsg="libcurl failed to execute the HTTP POST transaction"
        local expectedErrCode=17
        qaRun "ipa-join --server=$server_TestValue_Negative  --keytab=$keytab_TestValue " "$tmpout" $expectedErrCode "$expectedErrMsg" "test options:  [server]=[$server_TestValue_Negative] [keytab]=[$keytab_TestValue]" 
        Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1023

ipa_join_1024()
{
    rlPhaseStartTest "ipa_join_1024 [positive test] --server;positive;FQDN"
        local testID="ipa_join_1024"
        local tmpout=$TmpDir/ipa_join_1024.$RANDOM.out
        KinitAsAdmin
        local server_TestValue="$serverFQDN" #server;positive;FQDN
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        rlRun "ssh root@$serverFQDN \"ipa host-add $clientFQDN \"" 0 "add $clientFQDN from ipa server"
        rlRun "ipa-join --server=$server_TestValue " 0 "test options:  [server]=[$server_TestValue]" 
        Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1024

ipa_join_1025()
{
    rlPhaseStartTest "ipa_join_1025 [negative test] --server;positive;FQDN --bindpw;negative;InvalidPW"
        local testID="ipa_join_1025"
        local tmpout=$TmpDir/ipa_join_1025.$RANDOM.out
        #KinitAsAdmin
        local server_TestValue="$serverFQDN" #server;positive;FQDN
        local bindpw_TestValue_Negative="WrongPassword" #bindpw;negative;InvalidPW
        local expectedErrMsg="Incorrect password"
        local expectedErrCode=15
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        rlRun "ssh root@$serverFQDN \"ipa host-add $clientFQDN --password=$OTP\"" 0 "add $clientFQDN from ipa server"
        qaRun "ipa-join --server=$server_TestValue  --bindpw=$bindpw_TestValue_Negative " "$tmpout" $expectedErrCode "$expectedErrMsg" "test options:  [server]=[$server_TestValue] [bindpw]=[$bindpw_TestValue_Negative]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1025

ipa_join_1026()
{
    rlPhaseStartTest "ipa_join_1026 [positive test] --server;positive;FQDN --bindpw;positive;ValidPW"
        local testID="ipa_join_1026"
        local tmpout=$TmpDir/ipa_join_1026.$RANDOM.out
        #KinitAsAdmin
        local server_TestValue="$serverFQDN" #server;positive;FQDN
        local bindpw_TestValue=$OTP #bindpw;positive;ValidPW
        rlRun "ipa-join --server=$server_TestValue  --bindpw=$bindpw_TestValue " 0 "test options:  [server]=[$server_TestValue] [bindpw]=[$bindpw_TestValue]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1026

ipa_join_1027()
{
    rlPhaseStartTest "ipa_join_1027 [positive test] --server;positive;FQDN --keytab;positive;ValidKeytab"
        local testID="ipa_join_1027"
        local tmpout=$TmpDir/ipa_join_1027.$RANDOM.out
        KinitAsAdmin
        local server_TestValue="$serverFQDN" #server;positive;FQDN
        local keytab_TestValue="$testKeytabfile" #keytab;positive;ValidKeytab
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        rlRun "ssh root@$serverFQDN \"ipa host-add $clientFQDN \"" 0 "add $clientFQDN from ipa server"
        rlRun "ipa-join --server=$server_TestValue  --keytab=$keytab_TestValue " 0 "test options:  [server]=[$server_TestValue] [keytab]=[$keytab_TestValue]" 
        Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1027

ipa_join_1028()
{
    rlPhaseStartTest "ipa_join_1028 [negative test] --bindpw;negative;InvalidPW"
        local tmpout=$TmpDir/ipa_join_1028.$RANDOM.out
        #KinitAsAdmin
        local bindpw_TestValue_Negative="WrongPassword" #bindpw;negative;InvalidPW
        local expectedErrMsg="Incorrect password"
        local expectedErrCode=15
        rlRun "ssh root@$serverFQDN \"ipa host-del $clientFQDN\"" 0 "delete $clientFQDN from ipa server"
        rlRun "ssh root@$serverFQDN \"ipa host-add $clientFQDN --password=$OTP \"" 0 "add $clientFQDN from ipa server"
        qaRun "ipa-join --bindpw=$bindpw_TestValue_Negative " "$tmpout" $expectedErrCode "$expectedErrMsg" "test options:  [bindpw]=[$bindpw_TestValue_Negative]" 
        #Kcleanup
        rm $tmpout
    rlPhaseEnd
} #ipa_join_1028

#END OF TEST CASE for [ipa-join]
