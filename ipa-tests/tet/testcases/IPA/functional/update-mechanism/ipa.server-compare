#!/bin/sh

. ./testvars

compare(){
        before=$1
        after=$2
        echo "start comapre data"
        echo "diff the user data file"
        diff $before/userRoot.ldif $after/userRoot.ldif > $db
        echo "diff the schema files"
        diff -r $before/schema/ $after/schema/ | grep -v "#" > $schema
}

analysis(){
	if grep "<" $db
	then
		echo "found some un-usual place", please check diff file [$db]
	else
		echo "everything looks file, the diff file is here [$db]"	
	fi

	if grep "<" $schema | grep -v "#"
	then
		echo "found some un-usual place", please check diff file [$db]
	else
		echo "everything looks file, the diff file is here [$db]"	
	fi
}

compare $BEFORE $AFTER 
analysis

